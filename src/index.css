@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================
   Design System (HSL)
   ========================= */
@layer base {
  :root {
    /* Fondo global exacto solicitado */
    --background: 210 50% 7%;          /* #09121B */
    --foreground: 220 13% 98%;

    --card: 220 13% 12%;
    --card-foreground: 220 13% 98%;

    --popover: 220 13% 12%;
    --popover-foreground: 220 13% 98%;

    /* Acentos */
    --primary: 239 84% 67%;
    --primary-foreground: 220 13% 98%;
    --primary-glow: 250 84% 74%;

    --secondary: 220 13% 14%;
    --secondary-foreground: 220 13% 98%;

    --muted: 220 13% 16%;
    --muted-foreground: 220 9% 65%;

    --accent: 220 13% 18%;
    --accent-foreground: 220 13% 98%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 220 13% 98%;

    --border: 220 13% 20%;
    --input: 220 13% 16%;
    --ring: 239 84% 67%;

    /* Chat */
    --chat-user: 239 84% 67%;
    --chat-assistant: 220 13% 16%;
    --chat-input: 220 13% 14%;

    /* Gradients util */
    --gradient-primary: linear-gradient(135deg, hsl(239 84% 67%), hsl(250 84% 74%));
    --gradient-card: linear-gradient(145deg, hsl(220 13% 12% / 0.8), hsl(220 13% 14% / 0.8));
    --gradient-glow: radial-gradient(circle at 50% 50%, hsl(239 84% 67% / 0.15), transparent 50%);

    /* Sombra */
    --shadow-primary: 0 10px 30px -10px hsl(239 84% 67% / 0.3);
    --shadow-card: 0 8px 32px hsl(220 13% 3% / 0.4);
    --shadow-glow: 0 0 40px hsl(239 84% 67% / 0.2);

    /* Anim */
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);

    --radius: 0.75rem;

    /* Sidebar (shadcn) */
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }

  .light {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 239 84% 67%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 239 84% 67%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * { @apply border-border; }

  body {
    @apply bg-background text-foreground font-sans antialiased;
    background-color: #09121B; /* fijo */
    background-image: var(--gradient-glow);
    background-attachment: fixed;
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: hsl(var(--muted)); }
  ::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
    border-radius: 3px;
  }
  ::-webkit-scrollbar-thumb:hover { background: hsl(var(--primary) / 0.8); }

  /* Glass util */
  .glass {
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    background: hsl(var(--card) / 0.8);
    border: 1px solid hsl(var(--border) / 0.5);
  }
  .glow { box-shadow: var(--shadow-glow); }
  .smooth { transition: var(--transition-smooth); }
}

/* ============================================================
   AURORA CSS-ONLY (sin GPU): show rápido + anti-banding total
   Estructura DOM esperada (como la que tenías con <div class="aurora ...">):
   <div class="aurora-css is-active">
     <div class="aurora-css__layer aurora-css__layer--a"></div>
     <div class="aurora-css__layer aurora-css__layer--b"></div>
     <div class="aurora-css__layer aurora-css__layer--c"></div>
     <div class="aurora-css__grain"></div>
     <div class="aurora-css__film"></div>
     <div class="aurora-css__vignette"></div>
   </div>
   Puedes mantener tu contenedor padre con position:relative y poner
   esta capa como primer hijo absolute inset-0 z-0. Activa/desactiva
   con la clase .is-active (añádela cuando la IA “piense”).
   ============================================================ */

.aurora-css {
  position: absolute;
  inset: 0;
  z-index: 0;               /* detrás del contenido */
  pointer-events: none;
  opacity: 0;               /* apagada por defecto */
  transition: opacity 900ms cubic-bezier(.22,.61,.36,1);
}
.aurora-css.is-active { opacity: 0.26; } /* intensidad del show */

.aurora-css__layer {
  position: absolute;
  inset: -10%;
  filter: blur(80px);       /* blur base grande para suavizar */
  opacity: 0.85;
  mix-blend-mode: screen;   /* suma luces sin oscurecer */
  animation: layer-move-1 6s cubic-bezier(.4,0,.2,1) infinite alternate;
  will-change: transform, background-position, opacity, filter;
}

/* Capa A: varios radial-gradients grandes que barren horizontal */
.aurora-css__layer--a {
  background:
    radial-gradient(40% 60% at 20% 30%, #49F1D7 0%, transparent 60%),
    radial-gradient(50% 50% at 80% 40%, #4BEBCF 0%, transparent 60%),
    radial-gradient(45% 55% at 50% 70%, #48F7E6 0%, transparent 65%);
  animation:
    layer-move-1 5.5s cubic-bezier(.4,0,.2,1) infinite alternate,
    shimmer-a 3.6s linear infinite;
}

/* Capa B: conic-gradients girando para “ondas” de color */
.aurora-css__layer--b {
  background:
    conic-gradient(from 0deg at 30% 50%, rgba(178,240,217,0.35), rgba(73,241,215,0.0) 60%),
    conic-gradient(from 180deg at 70% 50%, rgba(72,247,230,0.35), rgba(75,235,207,0.0) 60%);
  animation:
    layer-move-2 7s cubic-bezier(.4,0,.2,1) infinite alternate,
    rotate-soft 20s linear infinite,
    shimmer-b 4.0s linear infinite;
  opacity: 0.6;
}

/* Capa C: mezcla de ambos para llenar huecos */
.aurora-css__layer--c {
  background:
    radial-gradient(55% 60% at 60% 20%, rgba(178,240,217,0.5) 0%, transparent 65%),
    conic-gradient(from 90deg at 40% 60%, rgba(73,241,215,0.35), rgba(72,247,230,0.0) 60%);
  animation:
    layer-move-3 6.2s cubic-bezier(.4,0,.2,1) infinite alternate,
    rotate-soft 24s linear infinite reverse,
    shimmer-c 3.4s linear infinite;
  opacity: 0.7;
}

/* ===== Anti-banding: grano multicapa + film grain + viñeta ===== */
.aurora-css__grain {
  position: absolute;
  inset: -6%;
  z-index: 1;
  pointer-events: none;
  opacity: 0.10; /* ajusta 0.06–0.14 */
  mix-blend-mode: overlay;
  animation: grain-pan 14s linear infinite;
  background-image:
    radial-gradient(circle, rgba(255,255,255,.08) 0 1px, transparent 1px),
    radial-gradient(circle, rgba(0,0,0,.08) 0 1px, transparent 1px),
    radial-gradient(circle, rgba(255,255,255,.05) 0 1px, transparent 1px);
  background-size: 130px 130px, 190px 190px, 250px 250px;
  background-position: 0 0, 60px 30px, 90px 60px;
  filter: contrast(120%) brightness(105%);
}

.aurora-css__film {
  position: absolute;
  inset: -6%;
  z-index: 2;
  pointer-events: none;
  opacity: 0.06; /* 0.04–0.08 */
  mix-blend-mode: soft-light;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='220' height='220'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.95' numOctaves='4' stitchTiles='stitch'/></filter><rect width='100%%' height='100%%' filter='url(%23n)'/></svg>");
  background-size: 220px 220px;
  animation: film-jitter 2.2s steps(2,end) infinite;
}

.aurora-css__vignette {
  position: absolute;
  inset: -14%;
  z-index: 3;
  pointer-events: none;
  background:
    radial-gradient(ellipse at center,
      rgba(0,0,0,0) 0%,
      rgba(0,0,0,0.02) 60%,
      rgba(0,0,0,0.06) 90%,
      rgba(0,0,0,0.08) 100%);
  mix-blend-mode: multiply;
}

/* ===== Keyframes para movimiento y anti-banding ===== */
@keyframes layer-move-1 {
  0%   { transform: translate(-18%, -6%) scale(1.02); }
  50%  { transform: translate(  6%, 10%) scale(1.06); }
  100% { transform: translate( 18%, -8%) scale(1.00); }
}
@keyframes layer-move-2 {
  0%   { transform: translate( 14%, -10%) scale(1.00); }
  50%  { transform: translate(-10%,  12%) scale(1.07); }
  100% { transform: translate(-22%,  -6%) scale(1.02); }
}
@keyframes layer-move-3 {
  0%   { transform: translate(-16%,  12%) scale(0.98); }
  50%  { transform: translate( 12%,  -8%) scale(1.06); }
  100% { transform: translate( 20%,   6%) scale(1.00); }
}
@keyframes rotate-soft { to { transform: rotate(360deg); } }

@keyframes shimmer-a {
  0% { background-position: 0% 50%, 100% 50%, 50% 50%; }
  100% { background-position: 100% 50%, 0% 50%, 50% 50%; }
}
@keyframes shimmer-b {
  0% { background-position: 0% 0%, 100% 100%; }
  100% { background-position: 100% 100%, 0% 0%; }
}
@keyframes shimmer-c {
  0% { background-position: 50% 0%, 0% 50%; }
  100% { background-position: 50% 100%, 100% 50%; }
}

@keyframes grain-pan {
  0%   { background-position: 0 0, 60px 30px, 90px 60px; }
  50%  { background-position: 50px 25px, 110px 55px, 140px 95px; }
  100% { background-position: 0 0, 60px 30px, 90px 60px; }
}
@keyframes film-jitter {
  0%   { transform: translate(0,0); }
  25%  { transform: translate(-1%, 1%); }
  50%  { transform: translate(1%, -1%); }
  75%  { transform: translate(-1%, 2%); }
  100% { transform: translate(0,0); }
}

/* ============================================================
   Fondo de gradiente global muy suave (idle)
   ============================================================ */
.chat-glow-bg {
  position: absolute;
  inset: 0;
  z-index: 0;
  background: linear-gradient(
    -45deg,
    #49F1D7,
    #4BEBCF,
    #B2F0D9,
    #F3F7F6,
    #48F7E6,
    #49F1D7
  );
  background-size: 400% 400%;
  animation: gradient-move 8s ease infinite;
  opacity: 0.10; /* muy bajo para no competir con aurora */
  pointer-events: none;
}
@keyframes gradient-move {
  0%   { background-position:   0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position:   0% 50%; }
}